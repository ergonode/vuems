---
title: Usage
description: 'VueMS usage'
position: 3
category: Guide
---

Implementation of the **VueMS module** itself does not lead to changes in the architecture.

In order to use the new architecture you need to prepare a project for it and adapt to the rules of module creation.

<alert type="info">
  You can, of course, use the old approach to building applications together with the new approach to architecture.

  Mixing of these two approaches is <b>allowed</b>.

</alert>

## Installation of required libraries

The first step to the correct operation of **VueMS** is to install appropriate libraries.

### nuxt + vue

**VueMS** is a Nuxt module so it is obvious that the project should be based on **Vue + NuxtJS** technology.


<alert type="info">
  More about fast <b>NuxtJS</b> installation can be found <a href="https://nuxtjs.org/docs/2.x/get-started/installation" target="_blank">here</a>.
</alert>

### @nuxtjs/router

To connect the routing output from the modules you had to use a library that allows you to use your own routing configuration.

You can use your own `router.js` to handle your routes into your **NuxtJS** application.

<alert type="warning">
  This module disable the <code>pages/</code> directory into <b>NuxtJS</b> and will use a <code>router.js</code> file at your <code>srcDir</code> directory.
</alert>


```
npm install --save-dev @nuxtjs/router
```

```javascript{}[nuxt.config.js]
  export default {
    buildModules: [
      '@nuxtjs/router',
    ]
  }
```

<alert type="info">
  More about <b>Nuxt Router Module</b> can be found <a href="https://github.com/nuxt-community/router-module" target="_blank">here</a>.
</alert>

## `modules` directory

Create an `modules` directory to keep the modules in it.

Directory should be located in the **root directory** of the project.

<alert type="info" align="center">
      <img src="examples/new_module_structure-desc.png" alt="Module structure">
</alert>

<alert type="info">
  If you want change directory name, look <a href="/options#modulesdir" >here</a>.
</alert>

## Add router

Create `router.js` file that need to export a `createRouter` method.

<alert type="info">
  The <code>router.js</code> file should be located in the <b>root directory</b> of the project.
</alert>

```javascript{}[router.js]
  import Vue from 'vue';
  import Router from 'vue-router';

  Vue.use(Router);

  export function createRouter() {
    return new Router({...})
  }

```

The next step is to load the routing from all modules.

This is done using the `extendRoutes` method, which is generated by the **VueMS** library.

<alert type="warning">
  If you have non-modular routing, you can pass it as an array as a parameter of the <code>extendRoutes</code> method.
</alert>


<code-group>
  <code-block label="Extend router" active>

 ```javascript{}[router.js]
    import Vue from 'vue';
    import Router from 'vue-router';

    import {
        extendRoutes,
    } from '~/.nuxt/routerHelper.modules';

    Vue.use(Router);

    export function createRouter() {
        return new Router({
            mode: 'history',
            base: '/',
            routes: extendRoutes(),
        });
    }
  ```
  </code-block>
    <code-block label="With local router">

 ```javascript{}[router.js]
    import Vue from 'vue';
    import Router from 'vue-router';

    import {
        extendRoutes,
    } from '~/.nuxt/routerHelper.modules';

    import localRouter from './router.local';

    Vue.use(Router);

    export function createRouter() {
        return new Router({
            mode: 'history',
            base: '/',
            routes: extendRoutes(localRouter),
        });
    }
  ```
  </code-block>
</code-group>

<alert type="info">
  More about <b>VueMS router API</b> can be found <a href="/router" >here</a>.
</alert>

## Add middleware

Middleware is a built-in **NuxtJS** mechanism.

By changes in the architecture you have to modify this mechanism.

<alert type="info">
  More about <b>NuxtJS middleware</b> can be found <a href="https://nuxtjs.org/docs/2.x/directory-structure/middleware" target="_blank" >here</a>.
</alert>

### Global middleware

This type of middleware will be called for every route change.


`modulesMiddlewareLoader` is an example file name, you can set up what you want.

```javascript{}[nuxt.config.js]
  export default {
    router: {
        middleware: [
            'modulesMiddlewareLoader',
        ],
    },
  }
```

The main middleware must be located in the `middleware` directory.
It imports a file created by **VueMS** that runs the global middleware from the modules.

```javascript{}[middleware/modulesMiddlewareLoader.js]
  import modulesMiddlewares from '~/.nuxt/middleware.modules';

  export default (ctx) => {
      modulesMiddlewares(ctx);
  };
```

### Local middleware

This type of middleware will be run on specific routing.

To a previously created `router.js` file you need to add an entry allowing you to add appropriate middleware to the routing.

Use the helper method `setLocalMiddlewares`, which we use as in the example.
The context given to the `setLocalMiddlewares` method will be available for all middlewares.

```javascript{}[router.js]
  import Vue from 'vue';
  import Router from 'vue-router';

  import {
      extendRoutes,
      setLocalMiddlewares,
  } from '~/.nuxt/routerHelper.modules';

  import localRouter from './router.local';

  Vue.use(Router);

  export function createRouter() {
      const router = new Router({
          mode: 'history',
          base: '/',
          routes: extendRoutes(localRouter),
      });

      router.beforeEach(
          (to, from, next) => setLocalMiddlewares({
              to,
              from,
              next,
          }),
      );

      return router;
  }
```

<alert type="info">
  More about <b>VueMS middleware API</b> can be found <a href="/middleware" >here</a>.
</alert>
